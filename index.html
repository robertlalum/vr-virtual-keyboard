   <!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>WebXR VR Keyboard + Pointer</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
  <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/aframe-extras@6.1.1/dist/aframe-extras.min.js"></script>
  <style>
    body { margin: 0; font-family: sans-serif; }
    #uiHint { position: absolute; left: 12px; top: 12px; z-index: 10; color: white; background: rgba(0,0,0,0.4); padding:8px; border-radius:6px; }
  </style>
</head>
<body>
  <div id="uiHint">Open in Meta Quest Browser. Point + trigger to type. Use grip to toggle pointer drag.</div>

  <a-scene background="color: #111" vr-mode-ui="enterVRButton: true">
    <!-- Camera + Controllers -->
    <a-entity id="cameraRig">
      <a-entity id="camera" camera look-controls position="0 1.6 0"></a-entity>

      <a-entity id="rightHand" laser-controls="hand: right" raycaster="objects: .key; far: 10; showLine: true"></a-entity>
      <a-entity id="leftHand" laser-controls="hand: left" raycaster="objects: .key; far: 10; showLine: true"></a-entity>
    </a-entity>

    <!-- Text panel -->
    <a-entity id="screen" position="0 1.6 -1.2">
      <a-plane width="1.6" height="0.6" color="#222" material="shader:flat" position="0 0 0"></a-plane>
      <a-entity id="typedText" position="-0.74 0.18 0.01" text="value: ; color: #fff; width: 2.2; align: left; wrapCount: 45"></a-entity>
      <a-entity id="cursorBlink" geometry="primitive: plane; width:0.01; height:0.04" material="color: #fff" position="0.72 -0.18 0.01" visible="false"></a-entity>
    </a-entity>

    <!-- Keyboard container -->
    <a-entity id="keyboard" position="0 1.25 -1.2"></a-entity>

    <!-- Pointer dot -->
    <a-sphere id="pointerDot" radius="0.01" position="0 1.55 -0.9" visible="false"></a-sphere>

    <!-- Floor -->
    <a-plane rotation="-90 0 0" width="10" height="10" color="#0b0b0b" position="0 0 -2"></a-plane>

    <a-entity light="type: ambient; intensity: 0.5"></a-entity>
    <a-entity light="type: directional; intensity: 0.7" position="-1 2 1"></a-entity>
  </a-scene>

<script>
  // VR Keyboard layout
  const layout = [
    ['1','2','3','4','5','6','7','8','9','0'],
    ['q','w','e','r','t','y','u','i','o','p'],
    ['a','s','d','f','g','h','j','k','l'],
    ['z','x','c','v','b','n','m','Back'],
    ['Space','Enter','!','@','#','$']
  ];

  // Typed text buffer
  let buffer = '';
  const typedText = document.getElementById('typedText');

  function updateScreen() {
    typedText.setAttribute('text', 'value', buffer);
  }

  function handleKey(k) {
    if(k === 'Back') buffer = buffer.slice(0,-1);
    else if(k === 'Space') buffer += ' ';
    else if(k === 'Enter') buffer += '\n';
    else buffer += k;
    updateScreen();
  }

  // Key component
  AFRAME.registerComponent('key-pressable', {
    init: function () {
      this.el.addEventListener('click', () => {
        const k = this.el.getAttribute('data-key');
        handleKey(k);
        this.el.setAttribute('scale','0.95 0.95 0.95');
        setTimeout(()=> this.el.setAttribute('scale','1 1 1'),80);
      });
    }
  });

  // Create keyboard in scene
  function createKeyboard() {
    const parent = document.getElementById('keyboard');
    const startX = -0.7;
    const keyW = 0.14;
    const keyH = 0.12;
    const rowGap = 0.015;

    layout.forEach((row, rowIndex) => {
      const y = 0.02 - rowIndex * (keyH + rowGap);
      let rowWidth = row.length * (keyW + 0.01);
      let x = startX + (1.0 - rowWidth)/2 + rowIndex*0.02;

      row.forEach((k) => {
        const w = (k==='Space') ? (keyW*5+0.04) : (k==='Enter'? keyW*1.7 : keyW);
        const el = document.createElement('a-entity');
        el.setAttribute('geometry', `primitive: plane; width: ${w}; height: ${keyH}`);
        el.setAttribute('material', 'color: #333; shader: flat');
        el.setAttribute('position', `${x + w/2} ${y} 0`);
        el.setAttribute('rotation','-30 0 0'); // tilt toward user
        el.setAttribute('class','key');
        el.setAttribute('data-key', k);
        el.setAttribute('key-pressable','');

        const label = document.createElement('a-entity');
        label.setAttribute('text', `value: ${k}; align: center; width: 2; color: #fff`);
        label.setAttribute('position','0 0 0.01');
        label.setAttribute('rotation','0 0 0');
        el.appendChild(label);

        parent.appendChild(el);
        x += w + 0.01;
      });
    });
  }

  createKeyboard();

  // Pointer / mouse emulation
  const rightHand = document.getElementById('rightHand');
  const leftHand = document.getElementById('leftHand');
  const pointerDot = document.getElementById('pointerDot');
  let dragging = false;

  function handleRayIntersect(evt) {
    const el = evt.detail.intersectedEl;
    if(!el) return;
    const point = evt.detail.intersection.point;
    pointerDot.setAttribute('position', `${point.x} ${point.y} ${point.z}`);
    pointerDot.setAttribute('visible', true);
  }

  function handleRayLeave() { pointerDot.setAttribute('visible', false); }

  rightHand.addEventListener('raycaster-intersection', handleRayIntersect);
  leftHand.addEventListener('raycaster-intersection', handleRayIntersect);
  rightHand.addEventListener('raycaster-intersection-cleared', handleRayLeave);
  leftHand.addEventListener('raycaster-intersection-cleared', handleRayLeave);

  function setupGripToggle(handEl) {
    handEl.addEventListener('gripdown', ()=>{ dragging = true; console.log('dragging ON'); });
    handEl.addEventListener('gripup', ()=>{ dragging = false; console.log('dragging OFF'); });
  }
  setupGripToggle(rightHand);
  setupGripToggle(leftHand);

  // Blink cursor
  setInterval(() => {
    const blink = document.getElementById('cursorBlink');
    blink.setAttribute('visible', !blink.getAttribute('visible'));
  }, 500);

  updateScreen();

</script>
</body>
</html>
       

                
        

  



